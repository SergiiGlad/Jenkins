@Library('my-shared-library') _

variable = 1



node {
    
    stage('test'){
    
    //checkout scm
    
           
    def scmVars = checkout([$class: 'GitSCM', branches: [[name: '*/master']],
     userRemoteConfigs: [[url: 'https://github.com/SergiiGlad/Jenkins.git']]])
     
   // sh 'printenv | sort'
    
    scmVars.GIT_COMMIT
        
    env.SHORT_GIT_COMMIT=scmVars.GIT_COMMIT[0..7]
    
    println scmVars.GIT_COMMIT
    
    println env.SHORT_GIT_COMMIT
    
    def repo = 'sergiiglad'
    
    image = repo + ':' + env.BRANCH_NAME 
    
    echo image
    
    sh "echo $image"
    
    println image
    
    println "HOSTNAME"
    
    log.info "info"
    
    println log.val()
    
     

    if  ( env.BRANCH_NAME ==~ /^\d.\d.\d$/ ) {
         println "tag name"
         println env.BRANCH_NAME
           
    } 
        
        variable = 2
        sh"""
            echo variable form sh: $variable
        """
        echo "variable: $variable"
        
       
        penv()
        

}//stage
  } //node  
            
    
    
 def penv() {
        
        println image
        sh"""
            echo "function penv"
            echo $image
        """   
}


    
        
